---
id: 251
title: Apache之suExec
date: 2009-03-02T14:43:44+00:00
author: edyliu
layout: post
guid: http://www.enlamp.cn/?p=251
permalink: '/2009-03-apache%e4%b9%8bsuexec/'
bttc_cache:
  - 1273354764:0
categories:
  - LAMP
tags:
  - server
---
Apache的suExec可以通过切换用户来提高一些应用的安全系数
  
今天配置的时候出现下列错误
  
&#8220;Internal Server Error&#8221;
  
检查日志
  
(13)Permission denied: exec of &#8216;/usr/sbin/suexec&#8217; failed
  
\[Mon Mar 02 13:35:55 2009\] \[error\] [client myip] Premature end of script headers: index.cgi
  
<!--more-->


  
就跑去找官方文档：
  
A message saying &#8220;Internal Server Error&#8221;
  
If you check the Apache error log, you will probably find that it says &#8220;Premature end of script headers&#8221;, possibly along with an error message generated by your CGI program. In this case, you will want to check each of the below sections to see what might be preventing your CGI program from emitting the proper HTTP headers.
  
对上号了，接下来就看看suExec了。发现如下说明：
  
If for example, your web server is configured to run as:
  
User www
  
Group webgroup
  
and suexec is installed at &#8220;/usr/local/apache2/bin/suexec&#8221;, you should run:
  
chgrp webgroup /usr/local/apache2/bin/suexec
  
chmod 4750 /usr/local/apache2/bin/suexec
  
This will ensure that only the group Apache runs as can even execute the suEXEC wrapper.
  
按照其意思修改suexec的权限，问题解决。
  
修改httpd.conf
  
User www-user
  
Group www-group
  
并执行如下命令
  
chgrp www-group /user/sbin/suexec
  
chmod 4750 /usr/sbin/suexec

Refer: http://httpd.apache.org/docs/2.2/howto/cgi.html
             
http://httpd.apache.org/docs/2.2/suexec.html